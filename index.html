<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>StickerShare</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Righteous&family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
</head>

<body>

<!-- LOGIN -->
<div id="login" class="login-screen">
  <div class="login-box">
    <h2>StickerShare</h2>
    <p class="subtitle">Partage tes meilleurs stickers</p>
    <div class="input-group">
      <label>Nom d'utilisateur</label>
      <input id="username" autocomplete="username">
    </div>
    <div class="input-group">
      <label>Mot de passe</label>
      <input id="password" type="password" autocomplete="current-password">
    </div>
    <button onclick="login()">Se connecter</button>
    <div id="loginMsg"></div>
  </div>
</div>

<!-- APP -->
<div id="app" class="app">
  <header>
    <div class="brand">
      <h1>StickerShare</h1>
    </div>
    <div class="user-info">
      <button class="btn-icon" onclick="toggleCall()" title="Appels">
        <span>ðŸ“ž</span>
      </button>
      <button class="btn-icon" onclick="toggleChat()" title="Chat">
        <span id="chatIcon">ðŸ’¬</span>
        <span class="badge" id="chatBadge" style="display:none;">0</span>
      </button>
      <button class="btn-icon" onclick="toggleNotifications()" title="Notifications">
        <span id="notifIcon">ðŸ”•</span>
      </button>
      <div class="user-badge">
        <strong id="userName"></strong>
        <span id="userRole"></span>
      </div>
      <button onclick="logout()">DÃ©connexion</button>
    </div>
  </header>

  <!-- CHAT SIDEBAR -->
  <div id="chatSidebar" class="chat-sidebar">
    <div class="chat-header">
      <h3>ðŸ’¬ Chat gÃ©nÃ©ral</h3>
      <button class="btn-close" onclick="toggleChat()">âœ•</button>
    </div>
    <div class="chat-messages" id="chatMessages"></div>
    <div class="chat-input-container">
      <input type="text" id="chatInput" placeholder="Ã‰cris un message..." />
      <button onclick="sendMessage()">Envoyer</button>
    </div>
  </div>

  <!-- CALL PANEL -->
  <div id="callPanel" class="call-panel">
    <div class="call-header">
      <h3>ðŸ“ž Appeler un ami</h3>
      <button class="btn-close" onclick="toggleCall()">âœ•</button>
    </div>
    <div class="users-list" id="usersList"></div>
    
    <!-- INCOMING CALL -->
    <div id="incomingCall" class="incoming-call" style="display:none;">
      <div class="call-content">
        <h3>ðŸ“ž Appel entrant</h3>
        <p id="callerName"></p>
        <div class="call-actions">
          <button class="btn-accept" onclick="acceptCall()">âœ“ Accepter</button>
          <button class="btn-decline" onclick="declineCall()">âœ• Refuser</button>
        </div>
      </div>
    </div>

    <!-- ACTIVE CALL -->
    <div id="activeCall" class="active-call" style="display:none;">
      <div class="call-content">
        <h3>ðŸ“ž En appel avec <span id="activeCallUser"></span></h3>
        <p id="callDuration">00:00</p>
        <div class="video-container">
          <video id="localVideo" autoplay muted playsinline></video>
          <video id="remoteVideo" autoplay playsinline></video>
        </div>
        <div class="call-controls">
          <button class="btn-mute" onclick="toggleMute()" title="Muet">ðŸŽ¤</button>
          <button class="btn-video" onclick="toggleVideo()" title="VidÃ©o">ðŸ“¹</button>
          <button class="btn-hangup" onclick="hangupCall()">ðŸ“ž Raccrocher</button>
        </div>
      </div>
    </div>
  </div>

  <div class="upload-section">
    <div class="upload-card">
      <h3>Partager un sticker</h3>
      <p class="subtitle">TÃ©lÃ©charge ton image et choisis une catÃ©gorie</p>
      <div class="upload-grid">
        <div class="file-input-wrapper">
          <input type="file" id="file" accept="image/*">
          <label class="file-input-label" for="file">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
            </svg>
            <span id="fileLabel">Choisir une image</span>
          </label>
        </div>
        <input type="text" id="customCategory" placeholder="Nom de la catÃ©gorie (ex: Memes, Anime, Citations...)">
      </div>
      <button onclick="upload()">Publier le sticker</button>
    </div>
  </div>

  <div class="stickers-section">
    <h3>Tous les stickers</h3>
    <div class="grid" id="grid"></div>
  </div>
</div>

<!-- Firebase SDK -->
<script type="module" src="script-firebase.js"></script>

</body>
</html>
